# 교육용 용어/시나리오 정리

## 용어
- SSI: 사용자가 자신의 신원정보를 스스로 보관/통제하는 모델
- DID: 중앙기관 없이 생성 가능한 분산 식별자
- DID Document: DID의 공개키/서비스 엔드포인트 등을 포함한 메타데이터
- VC: 발급자가 서명한 자격증명
- VP: 사용자가 VC를 묶어 제시하는 증명 패키지
- Issuer: VC 발급자
- Holder: VC 보유자(사용자)
- Relying Party(RP): VP 검증자(검증 기관)

## 프로젝트 구성과 용어 매핑
- DID-Registry: DID Document 저장소(LevelDB)
- DID-Registrar: DID method 라우팅 및 resolver
- demo-issuer: VC 발급자 역할(전자주민증/면허증/렌트카 계약)
- demo-rp: RP 역할(챌린지 인증, VP 검증)
- demo-client: Holder 역할(시나리오 실행)
- did_service_endpoint: REST 데모 API 및 Swagger

## 교육 시나리오 흐름
### 시나리오 A: DID 생성/등록/해결
1) Holder가 공개키로 DID 생성 요청
2) DID-Registrar가 DID 생성 및 Registry 저장
3) DID Resolve로 Document 조회

### 시나리오 B: 인증 챌린지/응답
1) Holder가 RP에 인증 요청
2) RP가 챌린지 문자열 발급
3) Holder가 복호화/서명 응답
4) RP가 응답 검증 후 통과

### 시나리오 C: VC 발급
1) Holder가 Issuer에 VC 요청
2) Issuer가 VC 발급(서명)
3) Holder가 VC 수신

### 시나리오 D: VP 제출/검증
1) Holder가 VC를 VP로 구성
2) RP에 VP 제출
3) RP가 서명/클레임 검증 후 결과 응답

### 시나리오 E: (선택) 온체인 레지스트리 연동
1) 테스트넷에 배포된 DID Registry 컨트랙트 연동
2) did:eth 방식으로 DID Document 저장/조회
3) `apps/geth_client`로 기본 상호작용 실습

### 시나리오 F: 신원 VC + 계약 VC 기반 차량 접근
**주체:** 사용자, 전자면허증 발급부서(issuer), 렌터카업체(rental), 차량  
**전제:** 사용자/발급부서/렌터카업체는 각각 자신의 DID를 보유

1) **사용자 DID 발급**
   - 사용자가 자신의 DID를 발급받는다(시간 제약 없음)
   - 이후 VC 발급 요청 인증 및 VP 서명에 사용

2) **전자면허증 VC 발급(신원 검증)**
   1) 사용자가 **DID Simple Presentation**(VP without VC) 제출
   2) 발급기관이 서명/nonce/aud 등으로 DID 소유자 검증
   3) 발급기관 DID로 서명된 **면허 VC** 발급 → 사용자 수신

3) **렌터카 계약 발급**
   1) 렌터카업체가 **aud(렌터카 DID) + nonce**를 제시
   2) 사용자가 면허 VC를 포함한 VP 생성 후 제출
   3) 렌터카업체가 다음을 검증:
      - VP 서명 무결성
      - aud/nonce 일치 여부
      - VP에 포함된 면허 VC 서명 무결성
      - 면허 VC 만료 여부
   4) 모든 검증 성공 시 **렌터카 계약 VC** 발급

4) **차량 접근 제어**
   1) 사용자가 렌터카 계약 VC로 VP 생성(랜덤 nonce 포함)
   2) 차량 주체가 VP/VC 무결성 검증 후 접근 허용

### UI 체크리스트(앱)
- **신원 VC 발급 단계**
  - [ ] DID 인증 유효
  - [ ] VC 생성 발급
- **계약 VC 발급 단계**
  - [ ] VP 서명 검증 유효
  - [ ] VP에 포함 요구한 2개 필드 확인(aud/nonce)
  - [ ] VP에 포함된 VC 무결성 체크 완료(서명/만료)
- **차량 접근 단계**
  - [ ] VP 무결성 체크 완료

## 실습 포인트
- DID Document 구조 확인
- VC/VP의 서명 및 검증
- gRPC 호출 흐름과 역할 분리 이해
- REST API는 보조 채널로 사용
