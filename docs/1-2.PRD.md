# PRD (요구사항 정의)

## 1. 목적
- SSI(Self-Sovereign Identity) 개념을 이해하고, DID/VC/VP 흐름을 실습 가능한 데모 플랫폼을 제공한다.
- gRPC 기반 분산 구성과 역할 분리를 통해 교육용 시나리오를 안정적으로 시연한다.
- REST/Android 데모를 통해 실제 서비스 흐름을 이해할 수 있도록 한다.

## 2. 범위
- DID 생성/등록/해결(Registry/Registrar)
- VC 발급 및 검증(issuer)
- VP 생성 및 검증(relying party)
- 인증 챌린지/리스폰스(Simple Presentation)
- REST 데모 API 및 Swagger 문서
- Android 데모 앱(REST 연동)

## 3. 비범위(Out of Scope)
- 메인넷/실서비스 보안 하드닝
- 분산 KMS/탈중앙 키 관리
- 멀티테넌트/권한관리/감사 로깅
- 고가용성(HA), 자동 스케일링

## 4. 대상 사용자
- 교육 참가자(개발자/기획자)
- SSI 개념 학습 및 실습 진행자
- 데모 앱 개발 담당자(안드로이드)

## 5. 핵심 사용자 시나리오
1) DID 생성 및 레지스트리 등록
2) 발급자(issuer)로부터 VC 발급
3) RP(relying party)에 VP 제출 및 검증
4) 인증 챌린지/리스폰스 기반 로그인 인증
5) 신원 VC → 계약 VC → 접근 제어 시나리오

## 6. 기능 요구사항
### 6.1 DID 관리
- DID 생성: 공개키(Base58)와 method로 DID 생성
- DID 등록: DID Document를 Registry에 저장
- DID 해석(Resolve): DID 입력 시 Document 조회
- DID 업데이트: Document 업데이트 요청 처리

### 6.2 VC/VP 발급 및 검증
- Issuer는 VC 발급 요청을 수신하고 서명된 VC를 응답
- Client는 VC를 기반으로 VP를 생성
- Relying Party는 VP 유효성을 검증

### 6.3 인증 챌린지/응답
- Relying Party는 DID 기반 인증 챌린지를 발급
- Client는 챌린지를 복호화/서명하여 응답
- Relying Party는 응답을 검증하고 결과 반환

### 6.4 REST 데모 API
- DID 생성/조회/공개키 조회
- VC/VP 생성 및 검증
- 데모 플로우(신원 VC/렌터카 계약 VC 발급)

## 7. 비기능 요구사항
- 로컬 개발 환경 기준 5개 서비스 동시 구동
- gRPC 통신 유지(교육용 핵심), REST는 보조
- DID/VC/VP 시나리오 데모 성공률 95% 이상
- 테스트: did 영역 커버리지 95% 목표

## 8. 인터페이스 요구사항
### 8.1 gRPC 서비스
- Registry
  - scCreateDID
  - scResolveDID
  - scUpdateDID
- Registrar
  - createDID
  - registerDID (PoC: Unimplemented)
  - resolveDID
  - updateDID
- Issuer
  - RequestCredential
  - ReqCredIdCard
  - ReqCredDlCard
  - ReqCredRentalCarAgreement
  - RentalCarControl
- RelyingParty
  - AuthChallenge
  - AuthResponse
  - SimplePresent
  - VerifyVp

### 8.2 REST 서비스
- did_service_endpoint
  - POST /v2/testapi/create-did
  - GET /v2/testapi/get-did/:some_id
  - GET /v2/testapi/get-did-public-key/:some_id
  - POST /v2/testapi/vc/create
  - POST /v2/testapi/vc/verify
  - POST /v2/testapi/vp/create
  - POST /v2/testapi/vp/verify
  - GET /v2/testapi/demo/actors
  - POST /v2/testapi/license/challenge
  - POST /v2/testapi/license/issue
  - POST /v2/testapi/rental/challenge
  - POST /v2/testapi/rental/issue

## 9. 데이터 요구사항
- DID Document: Registry에 저장 (LevelDB)
- VC/VP: JWT 기반 서명/검증
- 키: .env 기반 로컬 저장(교육 목적)

## 10. 환경/구성 요구사항
- configs/configs.yml 기반 서비스 주소/포트 설정
- .env에 ETH_PRIVATE_KEY_HEX 필수
- 기본 포트: 50051~50055

## 11. 테스트 요구사항
- 단위 테스트: `make unit-test`
- 통합 테스트: `make integration-test`
- 커버리지: `make coverage-did`

## 12. 릴리스 목표(교육용)
- v1: 로컬 데모 + CLI 기반 실습 완주
- v1.1: 안드로이드 데모 앱 연동
